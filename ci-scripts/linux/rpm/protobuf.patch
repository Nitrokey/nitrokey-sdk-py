diff --git a/poetry.lock b/poetry.lock
index 6038989..babcefb 100644
--- a/poetry.lock
+++ b/poetry.lock
@@ -1485,4 +1485,4 @@ type = ["pytest-mypy"]
 [metadata]
 lock-version = "2.0"
 python-versions = "^3.9"
-content-hash = "bf3cf1d5036f82de8a351d2da4aba6c8b2bf85fd6bd75e7b12502e0cca0057d2"
+content-hash = "141c56959904ac2d8688a01afa5350137365bbefce5e86c62fd77b37430b3520"
diff --git a/pyproject.toml b/pyproject.toml
index 99746df..9922246 100644
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -30,7 +30,7 @@ crcmod = "^1.7"
 hidapi = "^0.14"
 
 # nrf52
-protobuf = "^5.26"
+protobuf = ">=3.19"
 pyserial = "^3.5"
 
 [tool.poetry.group.dev]
diff --git a/src/nitrokey/trussed/_bootloader/nrf52_upload/dfu/dfu_cc_pb2.py b/src/nitrokey/trussed/_bootloader/nrf52_upload/dfu/dfu_cc_pb2.py
index f08f6b5..75d765e 100644
--- a/src/nitrokey/trussed/_bootloader/nrf52_upload/dfu/dfu_cc_pb2.py
+++ b/src/nitrokey/trussed/_bootloader/nrf52_upload/dfu/dfu_cc_pb2.py
@@ -1,53 +1,135 @@
 # -*- coding: utf-8 -*-
 # Generated by the protocol buffer compiler.  DO NOT EDIT!
 # source: src/nitrokey/trussed/_bootloader/nrf52_upload/dfu/dfu-cc.proto
-# Protobuf Python Version: 5.26.1
 """Generated protocol buffer code."""
+from google.protobuf.internal import enum_type_wrapper
 from google.protobuf import descriptor as _descriptor
 from google.protobuf import descriptor_pool as _descriptor_pool
+from google.protobuf import message as _message
+from google.protobuf import reflection as _reflection
 from google.protobuf import symbol_database as _symbol_database
-from google.protobuf.internal import builder as _builder
-
 # @@protoc_insertion_point(imports)
 
 _sym_db = _symbol_database.Default()
 
 
-DESCRIPTOR = _descriptor_pool.Default().AddSerializedFile(
-    b'\n>src/nitrokey/trussed/_bootloader/nrf52_upload/dfu/dfu-cc.proto\x12\x03\x64\x66u"6\n\x04Hash\x12 \n\thash_type\x18\x01 \x02(\x0e\x32\r.dfu.HashType\x12\x0c\n\x04hash\x18\x02 \x02(\x0c"C\n\x0e\x42ootValidation\x12!\n\x04type\x18\x01 \x02(\x0e\x32\x13.dfu.ValidationType\x12\x0e\n\x06\x62ytes_\x18\x02 \x02(\x0c"\xf8\x01\n\x0bInitCommand\x12\x12\n\nfw_version\x18\x01 \x01(\r\x12\x12\n\nhw_version\x18\x02 \x01(\r\x12\x12\n\x06sd_req\x18\x03 \x03(\rB\x02\x10\x01\x12\x19\n\x04type\x18\x04 \x01(\x0e\x32\x0b.dfu.FwType\x12\x0f\n\x07sd_size\x18\x05 \x01(\r\x12\x0f\n\x07\x62l_size\x18\x06 \x01(\r\x12\x10\n\x08\x61pp_size\x18\x07 \x01(\r\x12\x17\n\x04hash\x18\x08 \x01(\x0b\x32\t.dfu.Hash\x12\x17\n\x08is_debug\x18\t \x01(\x08:\x05\x66\x61lse\x12,\n\x0f\x62oot_validation\x18\n \x03(\x0b\x32\x13.dfu.BootValidation"\x1f\n\x0cResetCommand\x12\x0f\n\x07timeout\x18\x01 \x02(\r"i\n\x07\x43ommand\x12\x1c\n\x07op_code\x18\x01 \x01(\x0e\x32\x0b.dfu.OpCode\x12\x1e\n\x04init\x18\x02 \x01(\x0b\x32\x10.dfu.InitCommand\x12 \n\x05reset\x18\x03 \x01(\x0b\x32\x11.dfu.ResetCommand"m\n\rSignedCommand\x12\x1d\n\x07\x63ommand\x18\x01 \x02(\x0b\x32\x0c.dfu.Command\x12*\n\x0esignature_type\x18\x02 \x02(\x0e\x32\x12.dfu.SignatureType\x12\x11\n\tsignature\x18\x03 \x02(\x0c"S\n\x06Packet\x12\x1d\n\x07\x63ommand\x18\x01 \x01(\x0b\x32\x0c.dfu.Command\x12*\n\x0esigned_command\x18\x02 \x01(\x0b\x32\x12.dfu.SignedCommand*\x1d\n\x06OpCode\x12\t\n\x05RESET\x10\x00\x12\x08\n\x04INIT\x10\x01*n\n\x06\x46wType\x12\x0f\n\x0b\x41PPLICATION\x10\x00\x12\x0e\n\nSOFTDEVICE\x10\x01\x12\x0e\n\nBOOTLOADER\x10\x02\x12\x19\n\x15SOFTDEVICE_BOOTLOADER\x10\x03\x12\x18\n\x14\x45XTERNAL_APPLICATION\x10\x04*D\n\x08HashType\x12\x0b\n\x07NO_HASH\x10\x00\x12\x07\n\x03\x43RC\x10\x01\x12\n\n\x06SHA128\x10\x02\x12\n\n\x06SHA256\x10\x03\x12\n\n\x06SHA512\x10\x04*t\n\x0eValidationType\x12\x11\n\rNO_VALIDATION\x10\x00\x12\x1a\n\x16VALIDATE_GENERATED_CRC\x10\x01\x12\x13\n\x0fVALIDATE_SHA256\x10\x02\x12\x1e\n\x1aVALIDATE_ECDSA_P256_SHA256\x10\x03*3\n\rSignatureType\x12\x15\n\x11\x45\x43\x44SA_P256_SHA256\x10\x00\x12\x0b\n\x07\x45\x44\x32\x35\x35\x31\x39\x10\x01'
-)
-
-_globals = globals()
-_builder.BuildMessageAndEnumDescriptors(DESCRIPTOR, _globals)
-_builder.BuildTopDescriptorsAndMessages(
-    DESCRIPTOR, "src.nitrokey.trussed._bootloader.nrf52_upload.dfu.dfu_cc_pb2", _globals
-)
-if not _descriptor._USE_C_DESCRIPTORS:
-    DESCRIPTOR._loaded_options = None
-    _globals["_INITCOMMAND"].fields_by_name["sd_req"]._loaded_options = None
-    _globals["_INITCOMMAND"].fields_by_name["sd_req"]._serialized_options = b"\020\001"
-    _globals["_OPCODE"]._serialized_start = 783
-    _globals["_OPCODE"]._serialized_end = 812
-    _globals["_FWTYPE"]._serialized_start = 814
-    _globals["_FWTYPE"]._serialized_end = 924
-    _globals["_HASHTYPE"]._serialized_start = 926
-    _globals["_HASHTYPE"]._serialized_end = 994
-    _globals["_VALIDATIONTYPE"]._serialized_start = 996
-    _globals["_VALIDATIONTYPE"]._serialized_end = 1112
-    _globals["_SIGNATURETYPE"]._serialized_start = 1114
-    _globals["_SIGNATURETYPE"]._serialized_end = 1165
-    _globals["_HASH"]._serialized_start = 71
-    _globals["_HASH"]._serialized_end = 125
-    _globals["_BOOTVALIDATION"]._serialized_start = 127
-    _globals["_BOOTVALIDATION"]._serialized_end = 194
-    _globals["_INITCOMMAND"]._serialized_start = 197
-    _globals["_INITCOMMAND"]._serialized_end = 445
-    _globals["_RESETCOMMAND"]._serialized_start = 447
-    _globals["_RESETCOMMAND"]._serialized_end = 478
-    _globals["_COMMAND"]._serialized_start = 480
-    _globals["_COMMAND"]._serialized_end = 585
-    _globals["_SIGNEDCOMMAND"]._serialized_start = 587
-    _globals["_SIGNEDCOMMAND"]._serialized_end = 696
-    _globals["_PACKET"]._serialized_start = 698
-    _globals["_PACKET"]._serialized_end = 781
+
+
+DESCRIPTOR = _descriptor_pool.Default().AddSerializedFile(b'\n>src/nitrokey/trussed/_bootloader/nrf52_upload/dfu/dfu-cc.proto\x12\x03\x64\x66u\"6\n\x04Hash\x12 \n\thash_type\x18\x01 \x02(\x0e\x32\r.dfu.HashType\x12\x0c\n\x04hash\x18\x02 \x02(\x0c\"C\n\x0e\x42ootValidation\x12!\n\x04type\x18\x01 \x02(\x0e\x32\x13.dfu.ValidationType\x12\x0e\n\x06\x62ytes_\x18\x02 \x02(\x0c\"\xf8\x01\n\x0bInitCommand\x12\x12\n\nfw_version\x18\x01 \x01(\r\x12\x12\n\nhw_version\x18\x02 \x01(\r\x12\x12\n\x06sd_req\x18\x03 \x03(\rB\x02\x10\x01\x12\x19\n\x04type\x18\x04 \x01(\x0e\x32\x0b.dfu.FwType\x12\x0f\n\x07sd_size\x18\x05 \x01(\r\x12\x0f\n\x07\x62l_size\x18\x06 \x01(\r\x12\x10\n\x08\x61pp_size\x18\x07 \x01(\r\x12\x17\n\x04hash\x18\x08 \x01(\x0b\x32\t.dfu.Hash\x12\x17\n\x08is_debug\x18\t \x01(\x08:\x05\x66\x61lse\x12,\n\x0f\x62oot_validation\x18\n \x03(\x0b\x32\x13.dfu.BootValidation\"\x1f\n\x0cResetCommand\x12\x0f\n\x07timeout\x18\x01 \x02(\r\"i\n\x07\x43ommand\x12\x1c\n\x07op_code\x18\x01 \x01(\x0e\x32\x0b.dfu.OpCode\x12\x1e\n\x04init\x18\x02 \x01(\x0b\x32\x10.dfu.InitCommand\x12 \n\x05reset\x18\x03 \x01(\x0b\x32\x11.dfu.ResetCommand\"m\n\rSignedCommand\x12\x1d\n\x07\x63ommand\x18\x01 \x02(\x0b\x32\x0c.dfu.Command\x12*\n\x0esignature_type\x18\x02 \x02(\x0e\x32\x12.dfu.SignatureType\x12\x11\n\tsignature\x18\x03 \x02(\x0c\"S\n\x06Packet\x12\x1d\n\x07\x63ommand\x18\x01 \x01(\x0b\x32\x0c.dfu.Command\x12*\n\x0esigned_command\x18\x02 \x01(\x0b\x32\x12.dfu.SignedCommand*\x1d\n\x06OpCode\x12\t\n\x05RESET\x10\x00\x12\x08\n\x04INIT\x10\x01*n\n\x06\x46wType\x12\x0f\n\x0b\x41PPLICATION\x10\x00\x12\x0e\n\nSOFTDEVICE\x10\x01\x12\x0e\n\nBOOTLOADER\x10\x02\x12\x19\n\x15SOFTDEVICE_BOOTLOADER\x10\x03\x12\x18\n\x14\x45XTERNAL_APPLICATION\x10\x04*D\n\x08HashType\x12\x0b\n\x07NO_HASH\x10\x00\x12\x07\n\x03\x43RC\x10\x01\x12\n\n\x06SHA128\x10\x02\x12\n\n\x06SHA256\x10\x03\x12\n\n\x06SHA512\x10\x04*t\n\x0eValidationType\x12\x11\n\rNO_VALIDATION\x10\x00\x12\x1a\n\x16VALIDATE_GENERATED_CRC\x10\x01\x12\x13\n\x0fVALIDATE_SHA256\x10\x02\x12\x1e\n\x1aVALIDATE_ECDSA_P256_SHA256\x10\x03*3\n\rSignatureType\x12\x15\n\x11\x45\x43\x44SA_P256_SHA256\x10\x00\x12\x0b\n\x07\x45\x44\x32\x35\x35\x31\x39\x10\x01')
+
+_OPCODE = DESCRIPTOR.enum_types_by_name['OpCode']
+OpCode = enum_type_wrapper.EnumTypeWrapper(_OPCODE)
+_FWTYPE = DESCRIPTOR.enum_types_by_name['FwType']
+FwType = enum_type_wrapper.EnumTypeWrapper(_FWTYPE)
+_HASHTYPE = DESCRIPTOR.enum_types_by_name['HashType']
+HashType = enum_type_wrapper.EnumTypeWrapper(_HASHTYPE)
+_VALIDATIONTYPE = DESCRIPTOR.enum_types_by_name['ValidationType']
+ValidationType = enum_type_wrapper.EnumTypeWrapper(_VALIDATIONTYPE)
+_SIGNATURETYPE = DESCRIPTOR.enum_types_by_name['SignatureType']
+SignatureType = enum_type_wrapper.EnumTypeWrapper(_SIGNATURETYPE)
+RESET = 0
+INIT = 1
+APPLICATION = 0
+SOFTDEVICE = 1
+BOOTLOADER = 2
+SOFTDEVICE_BOOTLOADER = 3
+EXTERNAL_APPLICATION = 4
+NO_HASH = 0
+CRC = 1
+SHA128 = 2
+SHA256 = 3
+SHA512 = 4
+NO_VALIDATION = 0
+VALIDATE_GENERATED_CRC = 1
+VALIDATE_SHA256 = 2
+VALIDATE_ECDSA_P256_SHA256 = 3
+ECDSA_P256_SHA256 = 0
+ED25519 = 1
+
+
+_HASH = DESCRIPTOR.message_types_by_name['Hash']
+_BOOTVALIDATION = DESCRIPTOR.message_types_by_name['BootValidation']
+_INITCOMMAND = DESCRIPTOR.message_types_by_name['InitCommand']
+_RESETCOMMAND = DESCRIPTOR.message_types_by_name['ResetCommand']
+_COMMAND = DESCRIPTOR.message_types_by_name['Command']
+_SIGNEDCOMMAND = DESCRIPTOR.message_types_by_name['SignedCommand']
+_PACKET = DESCRIPTOR.message_types_by_name['Packet']
+Hash = _reflection.GeneratedProtocolMessageType('Hash', (_message.Message,), {
+  'DESCRIPTOR' : _HASH,
+  '__module__' : 'src.nitrokey.trussed._bootloader.nrf52_upload.dfu.dfu_cc_pb2'
+  # @@protoc_insertion_point(class_scope:dfu.Hash)
+  })
+_sym_db.RegisterMessage(Hash)
+
+BootValidation = _reflection.GeneratedProtocolMessageType('BootValidation', (_message.Message,), {
+  'DESCRIPTOR' : _BOOTVALIDATION,
+  '__module__' : 'src.nitrokey.trussed._bootloader.nrf52_upload.dfu.dfu_cc_pb2'
+  # @@protoc_insertion_point(class_scope:dfu.BootValidation)
+  })
+_sym_db.RegisterMessage(BootValidation)
+
+InitCommand = _reflection.GeneratedProtocolMessageType('InitCommand', (_message.Message,), {
+  'DESCRIPTOR' : _INITCOMMAND,
+  '__module__' : 'src.nitrokey.trussed._bootloader.nrf52_upload.dfu.dfu_cc_pb2'
+  # @@protoc_insertion_point(class_scope:dfu.InitCommand)
+  })
+_sym_db.RegisterMessage(InitCommand)
+
+ResetCommand = _reflection.GeneratedProtocolMessageType('ResetCommand', (_message.Message,), {
+  'DESCRIPTOR' : _RESETCOMMAND,
+  '__module__' : 'src.nitrokey.trussed._bootloader.nrf52_upload.dfu.dfu_cc_pb2'
+  # @@protoc_insertion_point(class_scope:dfu.ResetCommand)
+  })
+_sym_db.RegisterMessage(ResetCommand)
+
+Command = _reflection.GeneratedProtocolMessageType('Command', (_message.Message,), {
+  'DESCRIPTOR' : _COMMAND,
+  '__module__' : 'src.nitrokey.trussed._bootloader.nrf52_upload.dfu.dfu_cc_pb2'
+  # @@protoc_insertion_point(class_scope:dfu.Command)
+  })
+_sym_db.RegisterMessage(Command)
+
+SignedCommand = _reflection.GeneratedProtocolMessageType('SignedCommand', (_message.Message,), {
+  'DESCRIPTOR' : _SIGNEDCOMMAND,
+  '__module__' : 'src.nitrokey.trussed._bootloader.nrf52_upload.dfu.dfu_cc_pb2'
+  # @@protoc_insertion_point(class_scope:dfu.SignedCommand)
+  })
+_sym_db.RegisterMessage(SignedCommand)
+
+Packet = _reflection.GeneratedProtocolMessageType('Packet', (_message.Message,), {
+  'DESCRIPTOR' : _PACKET,
+  '__module__' : 'src.nitrokey.trussed._bootloader.nrf52_upload.dfu.dfu_cc_pb2'
+  # @@protoc_insertion_point(class_scope:dfu.Packet)
+  })
+_sym_db.RegisterMessage(Packet)
+
+if _descriptor._USE_C_DESCRIPTORS == False:
+
+  DESCRIPTOR._options = None
+  _INITCOMMAND.fields_by_name['sd_req']._options = None
+  _INITCOMMAND.fields_by_name['sd_req']._serialized_options = b'\020\001'
+  _OPCODE._serialized_start=783
+  _OPCODE._serialized_end=812
+  _FWTYPE._serialized_start=814
+  _FWTYPE._serialized_end=924
+  _HASHTYPE._serialized_start=926
+  _HASHTYPE._serialized_end=994
+  _VALIDATIONTYPE._serialized_start=996
+  _VALIDATIONTYPE._serialized_end=1112
+  _SIGNATURETYPE._serialized_start=1114
+  _SIGNATURETYPE._serialized_end=1165
+  _HASH._serialized_start=71
+  _HASH._serialized_end=125
+  _BOOTVALIDATION._serialized_start=127
+  _BOOTVALIDATION._serialized_end=194
+  _INITCOMMAND._serialized_start=197
+  _INITCOMMAND._serialized_end=445
+  _RESETCOMMAND._serialized_start=447
+  _RESETCOMMAND._serialized_end=478
+  _COMMAND._serialized_start=480
+  _COMMAND._serialized_end=585
+  _SIGNEDCOMMAND._serialized_start=587
+  _SIGNEDCOMMAND._serialized_end=696
+  _PACKET._serialized_start=698
+  _PACKET._serialized_end=781
 # @@protoc_insertion_point(module_scope)
diff --git a/src/nitrokey/trussed/_bootloader/nrf52_upload/dfu/dfu_cc_pb2.pyi b/src/nitrokey/trussed/_bootloader/nrf52_upload/dfu/dfu_cc_pb2.pyi
index 2b76934..0f3a803 100644
--- a/src/nitrokey/trussed/_bootloader/nrf52_upload/dfu/dfu_cc_pb2.pyi
+++ b/src/nitrokey/trussed/_bootloader/nrf52_upload/dfu/dfu_cc_pb2.pyi
@@ -1,183 +1,33 @@
-from typing import ClassVar as _ClassVar
-from typing import Iterable as _Iterable
-from typing import Mapping as _Mapping
-from typing import Optional as _Optional
-from typing import Union as _Union
-
-from google.protobuf import descriptor as _descriptor
-from google.protobuf import message as _message
-from google.protobuf.internal import containers as _containers
-from google.protobuf.internal import enum_type_wrapper as _enum_type_wrapper
-
-DESCRIPTOR: _descriptor.FileDescriptor
-
-class OpCode(int, metaclass=_enum_type_wrapper.EnumTypeWrapper):
-    __slots__ = ()
-    RESET: _ClassVar[OpCode]
-    INIT: _ClassVar[OpCode]
-
-class FwType(int, metaclass=_enum_type_wrapper.EnumTypeWrapper):
-    __slots__ = ()
-    APPLICATION: _ClassVar[FwType]
-    SOFTDEVICE: _ClassVar[FwType]
-    BOOTLOADER: _ClassVar[FwType]
-    SOFTDEVICE_BOOTLOADER: _ClassVar[FwType]
-    EXTERNAL_APPLICATION: _ClassVar[FwType]
-
-class HashType(int, metaclass=_enum_type_wrapper.EnumTypeWrapper):
-    __slots__ = ()
-    NO_HASH: _ClassVar[HashType]
-    CRC: _ClassVar[HashType]
-    SHA128: _ClassVar[HashType]
-    SHA256: _ClassVar[HashType]
-    SHA512: _ClassVar[HashType]
-
-class ValidationType(int, metaclass=_enum_type_wrapper.EnumTypeWrapper):
-    __slots__ = ()
-    NO_VALIDATION: _ClassVar[ValidationType]
-    VALIDATE_GENERATED_CRC: _ClassVar[ValidationType]
-    VALIDATE_SHA256: _ClassVar[ValidationType]
-    VALIDATE_ECDSA_P256_SHA256: _ClassVar[ValidationType]
-
-class SignatureType(int, metaclass=_enum_type_wrapper.EnumTypeWrapper):
-    __slots__ = ()
-    ECDSA_P256_SHA256: _ClassVar[SignatureType]
-    ED25519: _ClassVar[SignatureType]
-
-RESET: OpCode
-INIT: OpCode
-APPLICATION: FwType
-SOFTDEVICE: FwType
-BOOTLOADER: FwType
-SOFTDEVICE_BOOTLOADER: FwType
-EXTERNAL_APPLICATION: FwType
-NO_HASH: HashType
-CRC: HashType
-SHA128: HashType
-SHA256: HashType
-SHA512: HashType
-NO_VALIDATION: ValidationType
-VALIDATE_GENERATED_CRC: ValidationType
-VALIDATE_SHA256: ValidationType
-VALIDATE_ECDSA_P256_SHA256: ValidationType
-ECDSA_P256_SHA256: SignatureType
-ED25519: SignatureType
-
-class Hash(_message.Message):
-    __slots__ = ("hash_type", "hash")
-    HASH_TYPE_FIELD_NUMBER: _ClassVar[int]
-    HASH_FIELD_NUMBER: _ClassVar[int]
-    hash_type: HashType
-    hash: bytes
-    def __init__(
-        self,
-        hash_type: _Optional[_Union[HashType, str]] = ...,
-        hash: _Optional[bytes] = ...,
-    ) -> None: ...
-
-class BootValidation(_message.Message):
-    __slots__ = ("type", "bytes_")
-    TYPE_FIELD_NUMBER: _ClassVar[int]
-    BYTES__FIELD_NUMBER: _ClassVar[int]
-    type: ValidationType
-    bytes_: bytes
-    def __init__(
-        self,
-        type: _Optional[_Union[ValidationType, str]] = ...,
-        bytes_: _Optional[bytes] = ...,
-    ) -> None: ...
-
-class InitCommand(_message.Message):
-    __slots__ = (
-        "fw_version",
-        "hw_version",
-        "sd_req",
-        "type",
-        "sd_size",
-        "bl_size",
-        "app_size",
-        "hash",
-        "is_debug",
-        "boot_validation",
-    )
-    FW_VERSION_FIELD_NUMBER: _ClassVar[int]
-    HW_VERSION_FIELD_NUMBER: _ClassVar[int]
-    SD_REQ_FIELD_NUMBER: _ClassVar[int]
-    TYPE_FIELD_NUMBER: _ClassVar[int]
-    SD_SIZE_FIELD_NUMBER: _ClassVar[int]
-    BL_SIZE_FIELD_NUMBER: _ClassVar[int]
-    APP_SIZE_FIELD_NUMBER: _ClassVar[int]
-    HASH_FIELD_NUMBER: _ClassVar[int]
-    IS_DEBUG_FIELD_NUMBER: _ClassVar[int]
-    BOOT_VALIDATION_FIELD_NUMBER: _ClassVar[int]
-    fw_version: int
-    hw_version: int
-    sd_req: _containers.RepeatedScalarFieldContainer[int]
-    type: FwType
-    sd_size: int
-    bl_size: int
-    app_size: int
-    hash: Hash
-    is_debug: bool
-    boot_validation: _containers.RepeatedCompositeFieldContainer[BootValidation]
-    def __init__(
-        self,
-        fw_version: _Optional[int] = ...,
-        hw_version: _Optional[int] = ...,
-        sd_req: _Optional[_Iterable[int]] = ...,
-        type: _Optional[_Union[FwType, str]] = ...,
-        sd_size: _Optional[int] = ...,
-        bl_size: _Optional[int] = ...,
-        app_size: _Optional[int] = ...,
-        hash: _Optional[_Union[Hash, _Mapping]] = ...,  # type: ignore[type-arg]
-        is_debug: bool = ...,
-        boot_validation: _Optional[_Iterable[_Union[BootValidation, _Mapping]]] = ...,  # type: ignore[type-arg]
-    ) -> None: ...
-
-class ResetCommand(_message.Message):
-    __slots__ = ("timeout",)
-    TIMEOUT_FIELD_NUMBER: _ClassVar[int]
-    timeout: int
-    def __init__(self, timeout: _Optional[int] = ...) -> None: ...
-
-class Command(_message.Message):
-    __slots__ = ("op_code", "init", "reset")
-    OP_CODE_FIELD_NUMBER: _ClassVar[int]
-    INIT_FIELD_NUMBER: _ClassVar[int]
-    RESET_FIELD_NUMBER: _ClassVar[int]
-    op_code: OpCode
-    init: InitCommand
-    reset: ResetCommand
-    def __init__(
-        self,
-        op_code: _Optional[_Union[OpCode, str]] = ...,
-        init: _Optional[_Union[InitCommand, _Mapping]] = ...,  # type: ignore[type-arg]
-        reset: _Optional[_Union[ResetCommand, _Mapping]] = ...,  # type: ignore[type-arg]
-    ) -> None: ...
-
-class SignedCommand(_message.Message):
-    __slots__ = ("command", "signature_type", "signature")
-    COMMAND_FIELD_NUMBER: _ClassVar[int]
-    SIGNATURE_TYPE_FIELD_NUMBER: _ClassVar[int]
-    SIGNATURE_FIELD_NUMBER: _ClassVar[int]
-    command: Command
-    signature_type: SignatureType
-    signature: bytes
-    def __init__(
-        self,
-        command: _Optional[_Union[Command, _Mapping]] = ...,  # type: ignore[type-arg]
-        signature_type: _Optional[_Union[SignatureType, str]] = ...,
-        signature: _Optional[bytes] = ...,
-    ) -> None: ...
-
-class Packet(_message.Message):
-    __slots__ = ("command", "signed_command")
-    COMMAND_FIELD_NUMBER: _ClassVar[int]
-    SIGNED_COMMAND_FIELD_NUMBER: _ClassVar[int]
-    command: Command
-    signed_command: SignedCommand
-    def __init__(
-        self,
-        command: _Optional[_Union[Command, _Mapping]] = ...,  # type: ignore[type-arg]
-        signed_command: _Optional[_Union[SignedCommand, _Mapping]] = ...,  # type: ignore[type-arg]
-    ) -> None: ...
+from _typeshed import Incomplete
+
+DESCRIPTOR: Incomplete
+OpCode: Incomplete
+FwType: Incomplete
+HashType: Incomplete
+ValidationType: Incomplete
+SignatureType: Incomplete
+RESET: int
+INIT: int
+APPLICATION: int
+SOFTDEVICE: int
+BOOTLOADER: int
+SOFTDEVICE_BOOTLOADER: int
+EXTERNAL_APPLICATION: int
+NO_HASH: int
+CRC: int
+SHA128: int
+SHA256: int
+SHA512: int
+NO_VALIDATION: int
+VALIDATE_GENERATED_CRC: int
+VALIDATE_SHA256: int
+VALIDATE_ECDSA_P256_SHA256: int
+ECDSA_P256_SHA256: int
+ED25519: int
+Hash: Incomplete
+BootValidation: Incomplete
+InitCommand: Incomplete
+ResetCommand: Incomplete
+Command: Incomplete
+SignedCommand: Incomplete
+Packet: Incomplete
